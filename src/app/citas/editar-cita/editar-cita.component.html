<!------------------------------------------------------------------
|NOMBRE: editar-cita.                                              | 
|------------------------------------------------------------------|
|DESCRIPCIÓN: Página para editar o modificar citas.                |
|------------------------------------------------------------------|
|AUTOR: Ricardo Luna.                                              |
|------------------------------------------------------------------|
|FECHA: 20/08/2018.                                                |
|------------------------------------------------------------------|
|                       HISTORIAL DE CAMBIOS                       |
|------------------------------------------------------------------|
| #   |   FECHA  |     AUTOR      |           DESCRIPCIÓN          |
-------------------------------------------------------------------->
<div class="container">
  <div class="row">
    <div class="col-lg-3">
      <button type="button" class="btn btn-azul btn-lg" placement="bottom" ngbTooltip="Regresar al listado de citas." (click)="regresar()">
        <i class="material-icons">arrow_back</i>
      </button>
    </div>
    <div class="col-lg-6">
      <h1 class="display-4 text-center">Edición de cita</h1>
    </div>
  </div>
  <div class="row">
    <hr>
  </div>
  <form [formGroup]="formEdicionCitas" (ngSubmit)="editarCita()">
    <div class="row">
      <div class="col-lg-3"></div>
      <div class="col-lg-6">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">Usuario*</span>
          </div>
          <input type="text" class="form-control" [formControl]="usuarioControl" [ngbTypeahead]="buscarUsuario" (focus)="focusBuscarUsuario$.next($event.target.value)"
            (click)="clickBuscarUsuario$.next($event.target.value)" #usuarioHTML #usuarioNG="ngbTypeahead" ngbTooltip="Buscar por usuario."
            [resultFormatter]="formatoUsuarios" [inputFormatter]="formatoUsuarios" />
          <div class="input-group-append">
            <button class="btn btn-outline-secondary" type="button" (click)="limpiarCampoUsuario()" placement="bottom" ngbTooltip="Borrar contenido.">
              <i class="material-icons">backspace</i>
            </button>
          </div>
        </div>
        <div *ngIf="pulsarEditar && !usuarioControl.valid" class="col-lg-12 alert-danger text-center campo-invalido">El Usuario
          es Requerido.</div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-3"></div>
      <div class="col-lg-6">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">Paciente*</span>
          </div>
          <input type="text" class="form-control" [formControl]="pacienteControl" [ngbTypeahead]="buscarPaciente" (focus)="focusBuscarPaciente$.next($event.target.value)"
            (click)="clickBuscarPaciente$.next($event.target.value)" #pacienteHTML #pacienteNG="ngbTypeahead" ngbTooltip="Buscar por paciente."
            [resultFormatter]="formatoPacientes" [inputFormatter]="formatoPacientes" />
          <div class="input-group-append">
            <button class="btn btn-outline-secondary" type="button" (click)="limpiarCampoPaciente()" placement="bottom" ngbTooltip="Borrar contenido.">
              <i class="material-icons">backspace</i>
            </button>
          </div>
        </div>
        <div *ngIf="pulsarEditar && !pacienteControl.valid" class="col-lg-12 alert-danger text-center campo-invalido">El
          Paciente es Requerido.</div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-3"></div>
      <div class="col-lg-6">
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text">Clínica*</span>
          </div>
          <select class="form-control" [formControl]="clinicaControl" #clinicaHTML ngbTooltip="Seleccionar una clínica.">
            <option *ngFor="let clinica of clinicas" value={{clinica.id}}>
              {{clinica.nombre}}
            </option>
          </select>
        </div>
        <div *ngIf="pulsarEditar && !clinicaControl.valid" class="col-lg-12 alert-danger text-center campo-invalido">La clínica
          es Requerida.</div>
      </div>
    </div>
    <div class="row">
      <div class="col-lg-3"></div>
      <div class="col-lg-6">
        <button class="btn btn-lg btn-azul  btn-block" type="submit" ngbTooltip="Editar o modificar una cita.">Modificar</button>
      </div>
    </div>
  </form>
  <hr>
  <div class="row">
    <div class="col-lg-1">
      <button type="button" class="btn btn-azul btn-lg col-lg-12" placement="bottom" ngbTooltip="Agregar un evento a la cita."
        (click)="altaDetCita();">
        <i class="material-icons">add</i>
      </button>
    </div>
    <div class="col-lg-5">
      <div class="input-group input-group-lg">
        <input type="text" #buscarInfoHTML class="form-control" placeholder="Búsqueda">
        <div class="input-group-append">
          <button class="btn btn-azul" type="button" (click)="limpiarCampoBusqueda()" placement="bottom" ngbTooltip="Borrar búsqueda.">
            <i class="material-icons">backspace</i>
          </button>
        </div>
      </div>
    </div>
  </div>
  <br>
  <div class="row">
    <div class="col-lg-12 table-responsive">
      <div style="height:600px;overflow:auto;margin-right:15px;">
        <table class="table table-striped table-bordered">
          <thead>
            <tr>
              <th class="text-center">Evento</th>
              <th class="text-center">Fecha y hora</th>
              <th class="text-center">Opciones</th>
            </tr>
          </thead>
          <tbody *ngIf="detCitas.length > 0">
            <tr *ngFor="let detCita of detCitas">
              <td class="text-center">{{detCita.nombre}}</td>
              <td class="text-center">{{detCita.fecha}}</td>
              <td>
                <div class="btn-group btn-group-sm" role="group">            
                  <button *ngIf="eliminarDetCitas" type="button" class="btn" ngbTooltip="Eliminar evento permanentemente." (click)='eliminarDetCita(detCita.id)'>
                    <i class="material-icons">delete_forever</i>
                  </button>        
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>